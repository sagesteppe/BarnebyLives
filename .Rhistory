} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
mixed_datum <- data.frame(
datum = (rep(c('wGs84'), each = 15)),
longitude_dd = runif(15, min = -120, max = -100),
latitude_dd = runif(15, min = 35, max = 48)
)
coords2sf <- function(x, datum){
if(missing(datum)){ # identify datum information
if(
colnames(x)[grep('datum', colnames(x), ignore.case = T)] )#{}
#  } else {
#      x$datum = 'WGS84'}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
coords2sf(mixed_datum)
if(missing(datum)){ # identify datum information
if(
colnames(x)[grep('datum', colnames(x), ignore.case = T)] )#{}
#  } else {
#      x$datum = 'WGS84'}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
if(missing(datum)){ # identify datum information
if(
colnames(x)[grep('datum', colnames(x), ignore.case = T)] )#{}
#  } else {
#      x$datum = 'WGS84'}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf(mixed_datum)
#  return(x)
}
coords2sf(mixed_datum)
if(missing(datum)){ # identify datum information
if(
print( colnames(x)[grep('datum', colnames(x), ignore.case = T)] ) )#{}
#  } else {
#      x$datum = 'WGS84'}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf(mixed_datum)
if(missing(datum)){ # identify datum information
if(
print( colnames(x)[grep('datum', colnames(x), ignore.case = T)] ) )#{}
#  } else {
#      x$datum = 'WGS84'}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf(mixed_datum)
coords2sf(mixed_datum)
if(missing(datum)){ # identify datum information
if(
print( colnames(x)[grep('datum', colnames(x), ignore.case = T)] ) )#{}
#  } else {
#      x$datum = 'WGS84'}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
print( colnames(x)[grep('datum', colnames(x), ignore.case = T)] )
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf(mixed_datum)
mixed_datum <- data.frame(
DAtum = (rep(c('wGs84'), each = 15)),
longitude_dd = runif(15, min = -120, max = -100),
latitude_dd = runif(15, min = 35, max = 48)
)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
print( colnames(x)[grep('datum', colnames(x), ignore.case = T)] )
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
print( colnames(x)[grep('datum', colnames(x), ignore.case = T)] )
if(missing(datum)){ # identify datum information
x$datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] }
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
x$datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] }
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
#  return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
x$datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] }
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
xdatum_col = colnames(x)[grep('datum', colnames(x), ignore.case = T)] }
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] }
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
if(length(colnames(x)[grep('datum', colnames(x), ignore.case = T)]) == 1)
datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] } else {
{x$datum = 'WGS84'}
}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
mixed_datum <- data.frame(
#  DAtum = (rep(c('wGs84'), each = 15)),
longitude_dd = runif(15, min = -120, max = -100),
latitude_dd = runif(15, min = 35, max = 48)
)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
if(length(colnames(x)[grep('datum', colnames(x), ignore.case = T)]) == 1)
datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] } else {
{x$datum = 'WGS84'}
}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
if(length(colnames(x)[grep('datum', colnames(x), ignore.case = T)]) == 1)
datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] } else {
x$datum = 'WGS84'
}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
coords2sf <- function(x, datum){
library(magrittr)
# issue here, what do, create datum if is not supplied?
if(missing(datum)){ # identify datum information
if(length(colnames(x)[grep('datum', colnames(x), ignore.case = T)]) == 1){
datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] } else {
x$datum = 'WGS84'
}
}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
}
coords2sf(mixed_datum)
#' @param example mixed_datum <- data.frame(
#'  datum = (rep(c('nad27', 'NAD83', 'wGs84'), each = 5)),
#'  longitude_dd = runif(15, min = -120, max = -100),
#'  latitude_dd = runif(15, min = 35, max = 48)
#'  )
#'
#' wgs84_dat <- coords2sf( mixed_datum )
#' str(wgs84_dat)
#' st_crs(wgs84_dat)
#' @param export
coords2sf <- function(x, datum){
library(magrittr)
if(missing(datum)){ # identify datum information
if(length(colnames(x)[grep('datum', colnames(x), ignore.case = T)]) == 1){
datum = colnames(x)[grep('datum', colnames(x), ignore.case = T)] } else {
x$datum = 'WGS84'
}
}
dat_check <- function(x){if(grepl('nad.*27', ignore.case = T, x = x)) {
x = "NAD27"} else if(grepl('nad.*83', ignore.case = T, x = x)) {
x = 'NAD83'} else if(grepl('wgs', ignore.case = T, x = x)) {
x = "WGS84"
} else {x = 'WGS84'}
}
return(x)
# now ensure the datum is appropriate for each point
x$datum <- sapply(x$datum, dat_check)
crs_lkp = data.frame(
datum = c('NAD27', 'NAD83', 'WGS84'),
crs = c(4267, 4269, 4326))
x <- dplyr::left_join(x, crs_lkp, by = 'datum')
# separate all points by there datum
dat_list <- split(x, f = x$datum)
dat_list <- purrr::map(dat_list, . |>
sf::st_as_sf(., coords = c(x = 'longitude_dd', y = 'latitude_dd'),
crs = .$crs[1], remove = F) |>
sf::st_transform(4326)) |>
dplyr::bind_rows() %>%
dplyr::select(-crs) %>%
dplyr::mutate(datum = 'WGS84', .before = geometry)
return(dat_list)
}
coords2sf(mixed_datum)
devtools::build()
devtools::build()
R CMD check
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
checking DESCRIPTION meta-information ...
41.45 + 36.01 + 75.15 + 11.83 + 13.8 + 30.62 + 64.55 + 70.46 + 6.19
41.45 + 36.01 + 75.15 + 14.37 + 20.84 + 30.62 + 64.55 + 70.46 + 6.19
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message  = FALSE)
knitr::opts_chunk$set(warning = FALSE)
5.99 * 10
10 * 0.23
5.99 * 11
5.99 * 10.5
10.5 * 0.23
64.55 - (10.5 * 0.23)
5.99 * 10.4
10.4 * 0.23
(10.4 * 0.23) + (10.4 * 5.99)
(10.38 * 0.23) + (10.38 * 5.99)
(10.37 * 0.23) + (10.37 * 5.99)
(10.375 * 0.23) + (10.375 * 5.99)
(10.376 * 0.23) + (10.376 * 5.99)
(10.379 * 0.23) + (10.379 * 5.99)
(10.378 * 0.23) + (10.378 * 5.99)
devtools::install.github('sagesteppe/BarnebyLives')
install_github
??install_github
devtools::install_github('sagesteppe/BarnebyLives')
roxygen2::roxygenise()
roxygen2::roxygenise()
??unlist()
?adist
roxygen2::roxygenise()
??relocate
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
df <- data.frame(latitude_dd = 39.2558,
longitude_dd = -117.6827)
df
library(BarnebyLives)
View(df)
df$latitude_dd
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
df <- data.frame(latitude_dd = c(39.2558, 41.1234),
longitude_dd = c(-117.6827, -119.1234)) |>
sf::st_as_sf(coords = c(x = 'longitude_dd', y = 'latitude_dd'), crs = 4326)
View(df)
View(df)
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
SoS_gkey = Sys.getenv("Sos_gkey")
df <- data.frame(latitude_dd = c(39.2558, 41.1234),
longitude_dd = c(-117.6827, -119.1234),
Site_name = LETTERS[1:2]) |>
sf::st_as_sf(coords = c(x = 'longitude_dd', y = 'latitude_dd'), crs = 4326, remove = FALSE)
#' @examples
#' library(sf)
#' SoS_gkey = Sys.getenv("Sos_gkey") # import the key saved in the system environment
#' df <- data.frame(latitude_dd = c(39.2558, 41.1234),
#'      longitude_dd = c(-117.6827, -119.1234),
#'      Site_name = LETTERS[1:2]) |>
#'      sf::st_as_sf(coords = c(x = 'longitude_dd', y = 'latitude_dd'), crs = 4326, remove = FALSE)
#' dirs <- get_google_directions(x = df, apikey = SoS_gkey)
#' head(dirs)
#' @export
get_google_directions <- function(x, api_key){
# extract the coordinates to serve as the DESTINATION
coords <- lapply(x, '[', c( 'latitude_dd', 'longitude_dd'))
coords <- lapply(coords, sf::st_drop_geometry)
coords <- do.call(rbind, coords)
coords <- paste(coords$latitude_dd, coords$longitude_dd,  sep = ", ")
# identify the ORIGIN
data('places', envir=environment())
x <- dplyr::bind_rows(x)
origin <- places[ sf::st_nearest_feature(x, places), c('CITY', 'NAME')] |>
sf::st_drop_geometry()
origin <- paste0(origin$CITY, ', ', origin$NAME)
rm(places)
# run query
directions <- Map(f = googleway::google_directions, origin = origin,
destination = coords, key = api_key,
mode = "driving", simplify = TRUE)
# rename output to reflect either ORIGIN-SITE_NAME, ORIGIN_DEST_COORDS
names(directions) <- paste0(x$Site_name, '-', origin )
return(directions)
}
dirs <- get_google_directions(x = df, api_key = SoS_gkey)
directions_overview(dirs)
#' @examples
#' library(sf)
#' SoS_gkey = Sys.getenv("Sos_gkey") # import the key saved in the system environment
#' df <- data.frame(latitude_dd = c(39.2558, 41.1234),
#'      longitude_dd = c(-117.6827, -119.1234),
#'      Site_name = LETTERS[1:2]) |>
#'      sf::st_as_sf(coords = c(x = 'longitude_dd', y = 'latitude_dd'), crs = 4326, remove = FALSE)
#' dirs <- get_google_directions(x = df, apikey = SoS_gkey)
#' head(dirs)
#' @export
get_google_directions <- function(x, api_key){
# extract the coordinates to serve as the DESTINATION
coords <- lapply(x, '[', c( 'latitude_dd', 'longitude_dd'))
coords <- lapply(coords, sf::st_drop_geometry)
coords <- do.call(rbind, coords)
coords <- paste(coords$latitude_dd, coords$longitude_dd,  sep = ", ")
# identify the ORIGIN
data('places', envir=environment())
x <- dplyr::bind_rows(x)
origin <- places[ sf::st_nearest_feature(x, places), c('CITY', 'NAME')] |>
sf::st_drop_geometry()
origin <- paste0(origin$CITY, ', ', origin$NAME)
rm(places)
# run query
directions <- Map(f = googleway::google_directions, origin = origin,
destination = coords, key = api_key,
mode = "driving", simplify = TRUE)
# rename output to reflect either ORIGIN-SITE_NAME, ORIGIN_DEST_COORDS
#names(directions) <- paste0(x$Site_name, '-', origin)
return(origin)
}
dirs <- get_google_directions(x = df, api_key = SoS_gkey)
dirs
#' @examples
#' library(sf)
#' SoS_gkey = Sys.getenv("Sos_gkey") # import the key saved in the system environment
#' df <- data.frame(latitude_dd = c(39.2558, 41.1234),
#'      longitude_dd = c(-117.6827, -119.1234),
#'      Site_name = LETTERS[1:2]) |>
#'      sf::st_as_sf(coords = c(x = 'longitude_dd', y = 'latitude_dd'), crs = 4326, remove = FALSE)
#' dirs <- get_google_directions(x = df, apikey = SoS_gkey)
#' head(dirs)
#' @export
get_google_directions <- function(x, api_key){
# extract the coordinates to serve as the DESTINATION
coords <- lapply(x, '[', c( 'latitude_dd', 'longitude_dd'))
coords <- lapply(coords, sf::st_drop_geometry)
coords <- do.call(rbind, coords)
coords <- paste(coords$latitude_dd, coords$longitude_dd,  sep = ", ")
# identify the ORIGIN
data('places', envir=environment())
x <- dplyr::bind_rows(x)
origin <- places[ sf::st_nearest_feature(x, places), c('CITY', 'NAME')] |>
sf::st_drop_geometry()
origin <- paste0(origin$CITY, ', ', origin$NAME)
rm(places)
# run query
directions <- Map(f = googleway::google_directions, origin = origin,
destination = coords, key = api_key,
mode = "driving", simplify = TRUE)
# rename output to reflect either ORIGIN-SITE_NAME, ORIGIN_DEST_COORDS
# names(directions) <-
u <- paste0(x$Site_name, '-', origin)
return(u)
}
dirs <- get_google_directions(x = df, api_key = SoS_gkey)
directions_overview(dirs)
dirs <- get_google_directions(x = df, api_key = SoS_gkey)
dirs
roxygen2::roxygenise()
roxygen2::roxygenise()
rm(list = c("get_google_directions"))
roxygen2::roxygenise()
roxygen2::roxygenise()
